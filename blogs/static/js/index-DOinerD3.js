import{A as a}from"./index-WixhmZAK.js";import{e,q as l,F as t,r as s,o as n,c as o,w as r,a as i,j as d,B as u,t as c,s as v,h as m,Q as f,P as p,u as _,G as g,X as x,aF as y}from"./.pnpm-Bx6NWvas.js";import{u as h}from"./useToast-BbU7hDGx.js";import{u as b}from"./user-H3FtX9wW.js";const k=d("div",{class:"d-flex justify-center mt-auto text-h5"},"评星概述",-1),w={class:"d-flex align-center flex-column my-auto"},S={class:"text-h4 mt-2 mb-4"},A=d("span",{class:"text-h6 ml-n3"},"/5.0",-1),j={class:"px-3 mt-4"},C={class:"rating-values"},I={class:"d-flex justify-end"},X={key:0,class:"px-3 mt-4 font-black flex items-center animate__animated animate__fadeIn"},$=d("div",{class:"font-weight-bold ms-1 mb-2"},"Today",-1),F={class:"flex items-center mb-3"},J={class:"font-weight-normal"},M={class:"pr-4"},R=e({__name:"index",setup(e){const{showToast:R}=h(),T=l(),Y=l(!0),z=["bad","so so","ok","good","great"],N=["red","orange","grey","cyan","green"],V=l(4),B=b(),D=l(),H=l(),L=l(!0),P=async()=>{var e;if(null==(e=D.value)?void 0:e.isRating)return;const l=await a.Score.add_score_AXJAX({starsNum:V.value});200==l.code?(R("评星成功！谢谢您的支持Thanks♪(･ω･)ﾉ","success",7e3),q(),G()):R(`${l.msg}`,"error")},q=async()=>{const e=await a.Score.getScore_AJAX({userId:B.userInfo?B.userInfo.id:null});D.value=e.data,V.value=e.data.MyStar,e.data.isRating&&(L.value=!1)},G=async()=>{const e=await a.Score.getScoreList_AJAX();H.value=e.data},O=l(),Q=l(),U=l(),E=()=>{y({showProgress:!0,steps:[{element:O.value.$el,popover:{title:"评星概述模块",description:"通过该模块浏览博客的总打星量以及评星情况，欢迎留下你的⭐️，谢谢！"}},{element:Q.value.$el,popover:{title:"打⭐️模块",description:"通过鼠标划过星星，得到实时反馈，鼠标按下即可为网站评星"}},{element:U.value.$el,popover:{title:"星星总览",description:"浏览网站整体评星情况"}}]}).drive()};return t((()=>{(async()=>{const e=await a.getFrontCommits_AJAX();Y.value=!1,T.value=e.data})(),G(),q()})),(a,e)=>{const l=s("v-icon"),t=s("v-btn"),y=s("v-rating"),h=s("v-progress-linear"),b=s("v-list-item"),R=s("v-list"),B=s("SvgIcon"),q=s("v-card"),G=s("v-col"),K=s("v-avatar"),W=s("v-timeline-item"),Z=s("v-timeline"),aa=s("v-card-text"),ea=s("v-skeleton-loader"),la=s("v-row"),ta=s("v-container");return n(),o(ta,null,{default:r((()=>[i(la,null,{default:r((()=>[i(G,{cols:"12",md:"4",class:""},{default:r((()=>[i(q,{class:"d-flex flex-column mx-auto py-8 animate__animated animate__fadeInLeft",elevation:"2",height:"550",ref_key:"ratingOverviewCard",ref:O},{default:r((()=>{var a,s,g,x,$;return[d("div",{class:"absolute left-4 top-4",onClick:E},[i(t,{density:"compact",icon:""},{default:r((()=>[i(l,{icon:"mdi-help",size:"10"})])),_:1})]),k,d("div",w,[d("div",S,[u(c(null==(a=D.value)?void 0:a.proportion)+" ",1),A]),i(y,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),"item-labels":z,hover:L.value,ref_key:"rating_ref",ref:Q,readonly:null==(s=D.value)?void 0:s.isRating,onClick:P},{"item-label":r((a=>[d("span",{class:v([`text-${N[a.index]}`,"font-weight-black text-caption"])},c(a.label),3)])),_:1},8,["modelValue","hover","readonly"]),d("div",j," 总打星量 "+c(null==(g=D.value)?void 0:g.totalStarsCount),1)]),i(R,{"bg-color":"transparent",class:"d-flex flex-column-reverse",density:"compact",ref_key:"list_ref",ref:U},{default:r((()=>[(n(!0),m(p,null,f(H.value,(a=>(n(),o(b,{key:a.starsNum},{prepend:r((()=>[d("span",null,c(a.starsNum),1),i(l,{class:"mx-3",icon:"mdi-star"})])),append:r((()=>[d("div",C,[d("span",I,c(a.count),1)])])),default:r((()=>{var e;return[i(h,{"model-value":(a.count/(null==(e=D.value)?void 0:e.totalStarsCount)*100).toFixed(2),class:"mx-n5",color:"dark-blue",height:"9",rounded:""},null,8,["model-value"])]})),_:2},1024)))),128))])),_:1},512),(null==(x=D.value)?void 0:x.isRating)?(n(),m("div",X,[u(" 您的评星为： "),(n(!0),m(p,null,f(null==($=D.value)?void 0:$.MyStar,(a=>(n(),o(B,{name:"star",class:"ml-2 animate__animated animate__heartBeat",size:"17"})))),256))])):_("",!0)]})),_:1},512)])),_:1}),i(G,{cols:"12",md:"8",class:"d-flex justify-center"},{default:r((()=>[i(ea,{loading:Y.value,height:"740",type:"list-item-avatar,paragraph,article,paragraph,article,article",class:"w-full"},{default:r((()=>[i(q,{class:"w-full",elevation:"2"},{default:r((()=>[i(aa,null,{default:r((()=>[$,i(Z,{align:"start",density:"compact"},{default:r((()=>[(n(!0),m(p,null,f(T.value,(a=>(n(),o(W,{key:a.id,"dot-color":a.color,size:"x-small"},{default:r((()=>[d("div",F,[i(K,{image:a.avatar,class:"mr-4 self-start"},null,8,["image"]),d("div",null,[d("div",J,[d("strong",null,c(a.name),1),u(" @ "+c(g(x)(a.date).format("YYYY-MM-DD HH:mm:ss")),1)]),d("div",M,c(a.message),1)])])])),_:2},1032,["dot-color"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})}}});export{R as default};
