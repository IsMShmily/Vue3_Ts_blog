import{A as e}from"./index-WixhmZAK.js";import{u as a}from"./useToast-BbU7hDGx.js";import{e as l,q as s,r as t,o as d,c as u,w as o,a as n,B as i,j as r,F as c,h as m,G as v,aE as f,t as p,P as _,Q as g,X as x}from"./.pnpm-Bx6NWvas.js";import{u as b}from"./user-H3FtX9wW.js";const h=""+new URL("../png/bgc-BaLryc8s.png",import.meta.url).href,w=r("div",{class:"mb-2 text-xl"},"留言",-1),y=r("div",{class:"mb-3 text-xs"},"在留言簿中留下您的意见和见解",-1),V=l({__name:"dialog",emits:["updataList"],setup(l,{expose:r,emit:c}){const{showToast:m}=a(),v=s(!1),f=s(!1),p=s(""),_=s(),g=c,x=[e=>(null==e?void 0:e.length)>0||"留言消息不能为空",e=>(null==e?void 0:e.length)<=50||"留言消息不能超过50个字符"],b=async()=>{const a=await e.Message.add_message_AXJAX({content:p.value});200==a.code?(_.value.reset(),_.value.resetValidation(),v.value=!1,m("留言成功！","success"),g("updataList")):m(`${a.msg}`,"error")};return r({visable:v}),(e,a)=>{const l=t("v-textarea"),s=t("v-form"),r=t("v-icon"),c=t("v-btn"),m=t("v-card"),g=t("v-dialog");return d(),u(g,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),width:"auto"},{default:o((()=>[n(m,{class:"px-5 py-5","min-width":"330","max-width":"600"},{actions:o((()=>[n(c,{class:"ms-auto",onClick:b,disabled:!f.value},{append:o((()=>[n(r,{icon:"mdi-send-check-outline"})])),default:o((()=>[i(" 发送")])),_:1},8,["disabled"])])),default:o((()=>[w,y,n(s,{class:"w-full",modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e)},{default:o((()=>[n(l,{ref_key:"contentRef",ref:_,modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),rules:x,label:"留言消息",rows:"1",variant:"filled",counter:"","auto-grow":""},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])}}}),j={class:"w-screen min-h-screen"},k={class:"justify-self-end flex items-center"},A={class:"font-bold text-xs subheading me-2"},U=r("span",{class:"font-bold text-xs me-1"},"·",-1),L={class:"font-bold text-xs subheading me-2"},M={class:"flex justify-end"},X=l({__name:"index",setup(a){const l=b(),w=s(1),y=s(),X=s([]),Y=s(0),z=async()=>{const a=await e.Message.get_message_list_AJAX({page:w.value,size:9});Y.value=a.data.total,X.value=a.data.records},B=e=>{w.value=e,z()};return c((()=>{z()})),(e,a)=>{const s=t("v-card-title"),c=t("v-card-text"),b=t("v-btn"),I=t("v-img"),C=t("v-card"),D=t("v-col"),H=t("v-row"),J=t("v-avatar"),R=t("v-list-item-title"),T=t("SvgIcon"),q=t("v-list-item"),E=t("v-card-actions"),F=t("v-pagination"),G=t("v-container");return d(),m("div",j,[n(C,{class:"mx-auto",elevated:"15"},{default:o((()=>[n(H,{dense:""},{default:o((()=>[n(D,{cols:12},{default:o((()=>[n(C,null,{default:o((()=>[n(I,{src:v(h),class:"align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"300px",cover:""},{default:o((()=>[n(s,{class:"text-white"},{default:o((()=>[i("留言板")])),_:1}),n(c,{class:"text-white"},{default:o((()=>[i("在留言簿中留下您的意见和见解")])),_:1}),n(c,null,{default:o((()=>[n(b,{class:"mt-2",type:"submit",disabled:!v(l).userInfo,onClick:a[0]||(a[0]=e=>y.value.visable=!0)},{prepend:o((()=>[n(v(f),{size:13})])),default:o((()=>[i(" "+p(v(l).userInfo?"留个言":"登录后即可留言"),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["src"])])),_:1})])),_:1})])),_:1})])),_:1}),n(G,{class:"mb-6 mt-3"},{default:o((()=>[n(H,{class:"mb-3"},{default:o((()=>[(d(!0),m(_,null,g(X.value,(e=>(d(),u(D,{key:e.id,cols:"12",md:"4"},{default:o((()=>[n(C,{class:"mx-auto"},{prepend:o((()=>[n(J,{color:"grey-darken-3",image:e.user.avatar},null,8,["image"]),n(R,{class:"ml-3"},{default:o((()=>[i(p(e.user.username),1)])),_:2},1024)])),default:o((()=>[n(c,{class:"py-2"},{default:o((()=>[i(p(v(x)(null==e?void 0:e.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)])),_:2},1024),n(c,{class:"text_hide_two min-h-17"},{default:o((()=>[i(p(e.content),1)])),_:2},1024),n(E,null,{default:o((()=>[n(q,{class:"w-100"},{append:o((()=>[r("div",k,[n(T,{name:"xt",size:"18",class:"mr-2"}),r("span",A,p(e.os),1),U,r("span",L,p(e.Browser),1)])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),r("div",M,[n(F,{"onUpdate:modelValue":[B,a[1]||(a[1]=e=>w.value=e)],modelValue:w.value,length:Math.ceil(Y.value/9),class:"my-4","total-visible":7},null,8,["modelValue","length"])])])),_:1}),n(V,{ref_key:"dialog_ref",ref:y,onUpdataList:a[2]||(a[2]=()=>{w.value=1,z()})},null,512)])}}});export{X as default};
