import{e,q as a,r as l,o as t,c as s,w as o,a as u,B as i,j as d,C as n,D as r,E as c,F as v,h as m,G as p,I as f,J as _,M as g,S as x,u as h,K as y,L as w,N as k,O as V,U as b,P as C,Q as U,t as z,R as j,W as A,T as I,g as L}from"./.pnpm-Bx6NWvas.js";import{_ as S}from"./logo-sC22ddPd.js";import{r as $,_ as R}from"./index-Can_so1j.js";import{A as D}from"./index-WixhmZAK.js";import{u as H}from"./useToast-BbU7hDGx.js";import{u as J}from"./user-H3FtX9wW.js";const M=d("div",{class:"text-h5 text-medium-emphasis ps-2"},"注册您的账号",-1),N=d("div",{class:"text-medium-emphasis mb-4"},"请输入您的用户名和密码",-1),P=e({__name:"register",setup(e,{expose:d}){const{showToast:n}=H(),r=a(!1),c=a(""),v=a(""),m=a(""),p=a(""),f=a(!1),_=a(!1),g=a(),x=a(),h=a(!1),y=a(!1),w={email:[e=>!!e||"邮箱不能为空",e=>/.+@.+\..+/.test(e)||"请输入正确的邮箱"],code:[e=>!!e||"验证码不能为空",e=>4==(null==e?void 0:e.length)||"验证码应为4位字符"],password:[e=>!!e||"密码不能为空",e=>/^(?=.*[a-z])(?=.*\d)[a-zA-Z\d]{6,}$/.test(e)||"密码应为字母和数字组成，且不能小于6位"],AlignPassword:[e=>!!e||"确认密码不能为空",e=>e===m.value||"两次输入密码不一致"]},k=async()=>{if((await x.value.validate()).length)return;f.value=!0;const e=await D.getCode_AJAX({email:c.value});f.value=!1,200==e.code?n("发送成功！","success"):n(`发送失败：${e.msg}`,"error")},V=async()=>{if(m.value!=p.value)return void n("两次密码不一致","error");const{valid:e}=await g.value.validate();if(e){const e=await D.Login.register_AJAX({email:c.value,code:v.value,password:m.value});200==e.code?(g.value.reset(),g.value.resetValidation(),r.value=!1,n("注册成功","success")):n(`注册失败：${e.msg}`,"error")}};return d({signInDialog:r}),(e,a)=>{const d=l("v-btn"),n=l("v-card-title"),b=l("v-text-field"),C=l("v-icon"),U=l("v-card-actions"),z=l("v-form"),j=l("v-card-text"),A=l("v-card"),I=l("v-dialog");return t(),s(I,{modelValue:r.value,"onUpdate:modelValue":a[7]||(a[7]=e=>r.value=e),"max-width":"500"},{default:o((({isActive:e})=>[u(A,{rounded:"lg"},{default:o((()=>[u(n,{class:"d-flex justify-space-between align-center"},{default:o((()=>[M,u(d,{icon:"mdi-close",variant:"text",onClick:a=>e.value=!1},null,8,["onClick"])])),_:2},1024),u(j,null,{default:o((()=>[N,u(z,{class:"w-full",ref_key:"form_ref",ref:g,modelValue:_.value,"onUpdate:modelValue":a[6]||(a[6]=e=>_.value=e)},{default:o((()=>[u(b,{"hide-details":"auto",ref_key:"emailField",ref:x,modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),label:"邮箱",placeholder:"johndoe@163.com",rules:w.email},null,8,["modelValue","rules"]),u(b,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),loading:f.value,class:"mt-4",label:"输入验证码","hide-details":"auto",rules:w.code},{append:o((()=>[u(d,{onClick:k},{append:o((()=>[u(C,{icon:"mdi-email-arrow-right"})])),default:o((()=>[i(" 获取验证码 ")])),_:1})])),_:1},8,["modelValue","loading","rules"]),u(b,{"append-icon":h.value?"mdi-eye":"mdi-eye-off",class:"mt-4",modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value=e),type:h.value?"text":"password",hint:"密码应为字母和数字组成，且不能小于6位","hide-details":"auto",label:"密码",rules:w.password,"onClick:append":a[3]||(a[3]=e=>h.value=!h.value)},null,8,["append-icon","modelValue","type","rules"]),u(b,{class:"mt-4",modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value=e),"hide-details":"auto",label:"再次输入密码",type:y.value?"text":"password","append-icon":y.value?"mdi-eye":"mdi-eye-off","onClick:append":a[5]||(a[5]=e=>y.value=!y.value),rules:w.AlignPassword},null,8,["modelValue","type","append-icon","rules"]),u(U,{class:"my-2 d-flex justify-end"},{default:o((()=>[u(d,{class:"text-none",rounded:"xl",text:"注册",onClick:V},{prepend:o((()=>[u(C,{icon:"mdi-account-plus"})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:2},1024)])),_:1},8,["modelValue"])}}}),T=d("div",{class:"text-h5 text-medium-emphasis ps-2"},"登录您的账号",-1),F=d("div",{class:"text-medium-emphasis"},"请输入您的用户名和密码",-1),O=e({__name:"Login",setup(e,{expose:i}){const{showToast:d}=H(),n=a(!1),r=a(),c=()=>{r.value.signInDialog=!0},v={email:[e=>!!e||"邮箱不能为空",e=>/.+@.+\..+/.test(e)||"请输入正确的邮箱"],password:[e=>!!e||"密码不能为空",e=>/^(?=.*[a-z])(?=.*\d)[a-zA-Z\d]{6,}$/.test(e)||"密码应为字母和数字组成，且不能小于6位"]},m=a(!1),p=a(""),f=a(""),_=a(),g=async()=>{const{valid:e}=await _.value.validate();if(e){const e=await D.Login.login_AJAX({email:p.value,password:f.value});200==e.code?(n.value=!1,d(`登录成功！欢迎您${e.data.userName}`,"success"),await J().setUserInfo(e.data),_.value.reset(),_.value.resetValidation()):d(`登录失败：${e.msg}`,"error")}};return i({LoginDialogstatus:n}),(e,a)=>{const i=l("v-btn"),d=l("v-card-title"),x=l("v-card-text"),h=l("v-text-field"),y=l("v-form"),w=l("v-divider"),k=l("v-icon"),V=l("v-card-actions"),b=l("v-card"),C=l("v-dialog");return t(),s(C,{modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value=e),"max-width":"500"},{default:o((({isActive:e})=>[u(b,{rounded:"lg"},{default:o((()=>[u(d,{class:"d-flex justify-space-between align-center"},{default:o((()=>[T,u(i,{icon:"mdi-close",variant:"text",onClick:a=>e.value=!1},null,8,["onClick"])])),_:2},1024),u(x,null,{default:o((()=>[F])),_:1}),u(y,{class:"w-full",ref_key:"form_ref",ref:_,modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value=e)},{default:o((()=>[u(x,null,{default:o((()=>[u(h,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),"hide-details":"auto",rules:v.email,label:"邮箱"},null,8,["modelValue","rules"])])),_:1}),u(x,null,{default:o((()=>[u(h,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e),"hide-details":"auto",rules:v.password,label:"密码"},null,8,["modelValue","rules"])])),_:1})])),_:1},8,["modelValue"]),u(w,{class:"mt-2"}),u(V,{class:"my-2 d-flex justify-end"},{default:o((()=>[u(i,{class:"text-none",text:"去注册",onClick:c},{prepend:o((()=>[u(k,{icon:"mdi-account-convert"})])),_:1}),u(i,{"prepend-icon":"$vuetify",class:"text-none",text:"登录",onClick:g},{prepend:o((()=>[u(k,{icon:"mdi-arrow-up-bold-box-outline"})])),_:1})])),_:1})])),_:2},1024),u(P,{ref_key:"Register_ref",ref:r},null,512)])),_:1},8,["modelValue"])}}}),X=""+new URL("../png/noLogin-DKxiVid0.png",import.meta.url).href,B=e=>(j("data-v-b2eec74c"),e=e(),A(),e),G={class:"pe-4"},K=B((()=>d("div",{class:"flex items-center"},[d("img",{src:S,class:"rounded-full w-10",alt:""}),d("div",{class:"ml-3 font-bold cursor-pointer"},"Shmily_yy Blog")],-1))),Z={key:0,href:"https://github.com/login/oauth/authorize?client_id=Ov23ctUuyRd07F88pHxd&redirect_uri=https://www.shmilyyy.cn/#/home"},q={class:"text-xs flex justify-center items-center flex-col"},E=B((()=>d("div",{class:"mt-1 scale-x-75 scale-y-75"},"github",-1))),Q={class:"text-xs flex justify-center items-center flex-col"},W=B((()=>d("div",{class:"mt-1 scale-x-75 scale-y-75"},"已有用户",-1))),Y={class:"hidden-sm-and-down"},ee={key:0,href:"https://github.com/login/oauth/authorize?client_id=Ov23ctUuyRd07F88pHxd&redirect_uri=https://www.shmilyyy.cn/#/home"},ae={class:"text-xs flex justify-center items-center flex-col"},le=B((()=>d("div",{class:"mt-1 scale-x-75 scale-y-75"},"github",-1))),te={class:"text-xs flex justify-center items-center flex-col"},se=B((()=>d("div",{class:"mt-1 scale-x-75 scale-y-75"},"已有用户",-1))),oe=R(e({__name:"Head",setup(e){const{mdAndUp:j}=n(),A=J(),{userInfo:I,token:L}=r(A),S=c(),R=a(!1),H=a(!1),M=a(!1),N=[{title:"主页",value:"home",icon:"Home"},{title:"博客",value:"blogs",icon:"BookCheck"},{title:"留言",value:"leave",icon:"Send"},{title:"博客历程",value:"course",icon:"Users"},{title:"我的",value:"my",icon:"Users"}],P=e=>{localStorage.setItem("activeMenu",e.value),H.value=!1,$.push(e.value)},T=()=>{M.value=!1,A.delUserInfo(),$.push("/course"),localStorage.setItem("activeMenu","course")},F=a(localStorage.getItem("activeMenu")?localStorage.getItem("activeMenu"):"home"),B=()=>{S.global.name.value=S.global.current.value.dark?"light":"dark"},oe=a(),ue=a(!1),ie=a(""),de=()=>{oe.value.LoginDialogstatus=!0},ne=()=>{const e=new URL(window.location.href);e.searchParams.delete("code"),window.history.replaceState(null,"",e.toString())};return v((()=>{if(-1!=window.location.href.indexOf("code=")){ie.value="授权验证中...",ue.value=!0;(async e=>{try{const a=await D.Login.login_github_AJAX({code:e});200==a.code?(await J().setUserInfo(a.data),ie.value=`登录成功！欢迎您${I.value.userName}`):ie.value="登录失败！授权已过期，请重新授权"}catch(a){ie.value="登录失败！授权已过期，请重新授权"}finally{setTimeout((()=>{ue.value=!1,ie.value="",ne()}),2e3)}})(new URLSearchParams(window.location.search).get("code"))}})),(e,a)=>{const n=l("v-icon"),r=l("v-progress-circular"),c=l("v-list-item"),v=l("v-list"),A=l("v-dialog"),$=l("v-toolbar-title"),D=l("v-expand-x-transition"),J=l("v-btn"),ne=l("v-spacer"),re=l("v-card"),ce=l("v-list-item-title"),ve=l("v-btn-toggle"),me=l("v-menu"),pe=l("v-switch"),fe=l("v-avatar"),_e=l("v-toolbar"),ge=l("v-app-bar");return t(),m(C,null,[u(A,{modelValue:ue.value,"onUpdate:modelValue":a[0]||(a[0]=e=>ue.value=e),"max-width":"370",persistent:""},{default:o((()=>[u(v,{class:"py-2",elevation:"12",rounded:"lg"},{default:o((()=>[u(c,{"prepend-icon":"mdi-github",title:ie.value},{prepend:o((()=>[d("div",G,[u(n,{color:"shades",size:"x-large"})])])),append:o((()=>[u(r,{color:"shades",indeterminate:"disable-shrink",size:"16",width:"2"})])),_:1},8,["title"])])),_:1})])),_:1},8,["modelValue"]),u(ge,{"scroll-behavior":"elevate"},{default:o((()=>[u(_e,{color:"rgba(255,255,255,0.001)",dark:!0,class:"px-5 box-border"},{default:o((()=>[u($,{class:""},{default:o((()=>[K])),_:1}),p(j)?h("",!0):(t(),s(J,{key:0,class:"ml-3",onClick:B,size:"small",elevation:"3",rounded:"xl",icon:""},{default:o((()=>[u(D,null,{default:o((()=>[f(u(p(g),{size:17},null,512),[[_,!p(S).global.current.value.dark]])])),_:1}),u(D,null,{default:o((()=>[f(u(p(x),{size:17},null,512),[[_,p(S).global.current.value.dark]])])),_:1})])),_:1})),p(j)?(t(),m(C,{key:2},[u(pe,{onClick:B,"hide-details":"",class:"mr-5",color:"blue-grey-darken-2"}),u(ve,{modelValue:F.value,"onUpdate:modelValue":a[6]||(a[6]=e=>F.value=e),borderless:""},{default:o((()=>[(t(),m(C,null,U(N,(e=>u(J,{value:e.value,key:e.value,disabled:"my"==e.value&&!p(L),onClick:a=>P(e)},{default:o((()=>[d("span",Y,z(e.title),1)])),_:2},1032,["value","disabled","onClick"]))),64))])),_:1},8,["modelValue"]),u(me,{modelValue:H.value,"onUpdate:modelValue":a[11]||(a[11]=e=>H.value=e),"close-on-content-click":!1,location:"top"},{activator:o((({props:e})=>[u(J,y({size:"small",elevation:"3",icon:"",class:"ml-5",onClick:a[7]||(a[7]=e=>R.value=!0)},e),{default:o((()=>{var e,a;return[(null==(e=p(I))?void 0:e.avatar)?(t(),s(fe,{key:1,image:null==(a=p(I))?void 0:a.avatar},null,8,["image"])):(t(),s(fe,{key:0,image:p(X)},null,8,["image"]))]})),_:2},1040)])),default:o((()=>[u(re,{"min-width":"280"},{default:o((()=>[u(v,null,{default:o((()=>{var e,l;return[p(L)?(t(),s(c,{key:0,"prepend-avatar":null==(e=p(I))?void 0:e.avatar,subtitle:"欢迎来到shmily_yy的博客",title:null==(l=p(I))?void 0:l.userName},{append:o((()=>[u(A,{modelValue:M.value,"onUpdate:modelValue":a[9]||(a[9]=e=>M.value=e),"max-width":"400",persistent:""},{activator:o((({props:e})=>[u(J,y({variant:"text"},e),{default:o((()=>[u(p(k),{size:16})])),_:2},1040)])),default:o((()=>[u(re,{"prepend-icon":"mdi-logout-variant",title:"你确定要退出登录吗？"},{actions:o((()=>[u(ne),u(J,{onClick:a[8]||(a[8]=e=>M.value=!1)},{default:o((()=>[i(" 取消 ")])),_:1}),u(J,{onClick:T},{default:o((()=>[i(" 确认 ")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["prepend-avatar","title"])):h("",!0),p(L)?h("",!0):(t(),s(c,{key:1,class:"text-center"},{append:o((()=>[])),default:o((()=>[u(ce,null,{default:o((()=>[i("选择登录方式")])),_:1}),u(ce,{class:"mt-3"},{default:o((()=>[u(ve,{variant:"outlined"},{default:o((()=>[u(J,{variant:"text",onClick:a[10]||(a[10]=()=>{ue.value=!0,ie.value="GitHub 授权中..."})},{default:o((()=>[(t(),m("a",ee,[d("div",ae,[u(p(V),{size:16}),le])]))])),_:1}),u(J,{variant:"text",onClick:de},{default:o((()=>[d("div",te,[u(p(b),{size:16}),se])])),_:1})])),_:1})])),_:1})])),_:1}))]})),_:1})])),_:1})])),_:1},8,["modelValue"])],64)):(t(),s(me,{key:1,modelValue:H.value,"onUpdate:modelValue":a[5]||(a[5]=e=>H.value=e),"close-on-content-click":!1,location:"top"},{activator:o((({props:e})=>[u(J,y({size:"small",elevation:"3",icon:"",class:"ml-3",onClick:a[1]||(a[1]=e=>R.value=!0)},e),{default:o((()=>[u(p(w),{class:"cursor-pointer"})])),_:2},1040)])),default:o((()=>[u(re,{"min-width":"280"},{default:o((()=>[u(v,null,{default:o((()=>{var e,l;return[p(L)?(t(),s(c,{key:0,"prepend-avatar":null==(e=p(I))?void 0:e.avatar,subtitle:"欢迎来到shmily_yy的博客",title:null==(l=p(I))?void 0:l.userName},{append:o((()=>[u(A,{modelValue:M.value,"onUpdate:modelValue":a[3]||(a[3]=e=>M.value=e),"max-width":"400",persistent:""},{activator:o((({props:e})=>[u(J,y({variant:"text"},e),{default:o((()=>[u(p(k),{size:16})])),_:2},1040)])),default:o((()=>[u(re,{"prepend-icon":"mdi-logout-variant",title:"你确定要退出登录吗？"},{actions:o((()=>[u(ne),u(J,{onClick:a[2]||(a[2]=e=>M.value=!1)},{default:o((()=>[i(" 取消 ")])),_:1}),u(J,{onClick:T},{default:o((()=>[i(" 确认 ")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["prepend-avatar","title"])):(t(),s(c,{key:1,class:"text-center"},{append:o((()=>[])),default:o((()=>[u(ce,null,{default:o((()=>[i("选择登录方式")])),_:1}),u(ce,{class:"mt-3"},{default:o((()=>[u(ve,{variant:"outlined"},{default:o((()=>[u(J,{variant:"text",onClick:a[4]||(a[4]=()=>{ue.value=!0,ie.value="GitHub 授权中..."})},{default:o((()=>[(t(),m("a",Z,[d("div",q,[u(p(V),{size:16}),E])]))])),_:1}),u(J,{variant:"text",onClick:de},{default:o((()=>[d("div",Q,[u(p(b),{size:16}),W])])),_:1})])),_:1})])),_:1})])),_:1}))]})),_:1}),u(v,null,{default:o((()=>[(t(),m(C,null,U(N,((e,a)=>u(c,{key:a,class:"min-w-36 text-center cursor-pointer",disabled:"my"==e.value&&!p(L)},{default:o((()=>[u(ce,{onClick:a=>P(e)},{default:o((()=>[i(z(e.title),1)])),_:2},1032,["onClick"])])),_:2},1032,["disabled"]))),64))])),_:1})])),_:1})])),_:1},8,["modelValue"]))])),_:1})])),_:1}),u(O,{ref_key:"Login_ref",ref:oe},null,512)],64)}}}),[["__scopeId","data-v-b2eec74c"]]);const ue=R({},[["render",function(e,a){const i=l("router-view"),d=l("v-main");return t(),s(d,null,{default:o((()=>[u(i,null,{default:o((({Component:e})=>[u(I,{name:"fade",mode:"out-in",appear:""},{default:o((()=>[(t(),s(L(e)))])),_:2},1024)])),_:1})])),_:1})}],["__scopeId","data-v-0f94eaa8"]]),ie={class:"min-h-screen"},de=e({__name:"index",setup:e=>(e,a)=>{const s=l("v-layout");return t(),m("div",ie,[u(s,null,{default:o((()=>[u(oe),u(ue)])),_:1})])}});export{de as default};
